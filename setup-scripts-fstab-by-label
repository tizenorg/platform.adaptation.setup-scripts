#!/bin/sh
#
# Copyright 2013 Samsung Electronics
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

contents="
# Generated by setup-scripts-fstab-by-label
devpts  /dev/pts  devpts  gid=5,mode=620  0 0
tmpfs   /dev/shm  tmpfs   defaults        0 0
proc    /proc     proc    defaults        0 0
sysfs   /sys      sysfs   defaults        0 0

"
printf "%s" "$contents" > $INSTALLERFW_MOUNT_PREFIX/etc/fstab

for i in $(seq 0 $((${INSTALLERFW_PART_COUNT} - 1))); do
	eval fs_spec=/dev/disk/by-label/\$INSTALLERFW_PART${i}_LABEL
	eval fs_file=\$INSTALLERFW_PART${i}_MOUNTPOINT
	eval fs_vfstype=\$INSTALLERFW_PART${i}_FSTYPE
	eval fs_mntopts=\$INSTALLERFW_PART${i}_FSOPTS

	if [ "$fs_file" = "/" ]; then
		fs_passno=1
	else
		fs_passno=2
	fi

	# fs_spec fs_file fs_vfstype fs_mntopts fs_freq fs_passno
	#
	echo $fs_spec $fs_file $fs_vfstype $fs_mntopts 0 $fs_passno
done >> $INSTALLERFW_MOUNT_PREFIX/etc/fstab
